<?xml version="1.0" encoding="UTF-8" ?>
<Module>
    <ModulePrefs title="__MSG_gadget.title__"
		directory_title="__MSG_gadget.title__"
        description="__MSG_gadget.description__"
		author="Luke Halliwell"
		thumbnail="__ATLASSIAN_BASE_URL__/download/resources/com.jiraquips.jiraquips/thumbnail.png">
        <Optional feature="gadget-directory">
            <Param name="categories">
                JIRA
            </Param>
        </Optional>
		<Require feature="dynamic-height" /> 
		<Locale messages="__ATLASSIAN_BASE_URL__/download/resources/com.jiraquips.jiraquips/i18n/ALL_ALL.xml"/>
    </ModulePrefs>
    <Content type="html" view="profile">
        <![CDATA[
    #requireResource("com.atlassian.jira.gadgets:common")
    #includeResources()
 
    <div>
    <h4>The Quips Gadget</h4>
 
    <script type="text/javascript">
        (function () {
			var gadget = AJS.Gadget({
			baseUrl: "__ATLASSIAN_BASE_URL__",
			view: {
			template: function(args) {
				var gadget = this;
				gadget.getView().html(
					AJS.$("<em/>").text(args.quip.value));
					
				// Calculation of gadget height seems dodgy, it always chops off the bottom half line ... so,
				// total hack, but I just stick an extra bit of a line on at the end.
				// Not sure if I'm misusing the API or what.
				gadget.getView().append(AJS.$("<p/>").text("."));
			},
			args: [{
				key: "quip",
				ajaxOptions: function() {
					return {
						url: "/rest/quips/1.0/quips.json?key=random"
					};
				}
			}]
			}
			});
			})();
    </script>
	</div>
    ]]>
	</Content>
</Module>
